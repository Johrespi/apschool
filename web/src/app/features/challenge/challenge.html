<div class="challenge-container">
  @if (challenge(); as challenge) {
    <div class="challenge-layout">
      <!-- Panel izquierdo: descripción -->
      <div class="description-panel">
        <h1>{{ challenge.title }}</h1>
        <div class="description">
          <markdown [data]="challenge.description" />
        </div>
        @if (challenge.hints) {
          <details class="hints">
            <summary>Mostrar pistas</summary>
            <div class="hints-content">
              <markdown [data]="challenge.hints" />
            </div>
          </details>
        }
      </div>
      <!-- Panel derecho: editor y output -->
      <div class="editor-panel">
        <div class="editor-wrapper">
          <app-monaco-editor
            [value]="initialCode()"
            language="python"
            theme="vs"
            (valueChange)="onCodeChange($event)"
          />
        </div>
        <div class="output-wrapper">
          <pre class="output" [class.success]="lastResult()?.success" [class.error]="lastResult()?.error">{{ output() || 'La salida aparecerá aquí...' }}</pre>
        </div>
        <div class="actions">
          @if (pyodideLoading()) {
            <span class="loading-text">Cargando Python...</span>
          }
          <button
            mat-flat-button
            (click)="onRun()"
            [disabled]="isRunning() || pyodideLoading()"
          >
            {{ isRunning() ? 'Ejecutando...' : 'Ejecutar' }}
          </button>
          <button
            mat-flat-button
            color="primary"
            (click)="onSubmit()"
            [disabled]="!canSubmit() || isSubmitting() || isSubmitted()"
          >
            {{ submitButtonText() }}
          </button>
        </div>
      </div>
    </div>
  } @else {
    <div class="loading">Cargando challenge...</div>
  }
</div>
